#####################################################################################
###  Turn on the espresso machine at 5am and off at 3pm
#####################################################################################

- alias: 'Espresso Machine On'
  trigger:
    - platform: time
      at: '05:00:00'
  condition:
      condition: and
      conditions:
        - condition: state
          entity_id: group.mobile_trackers
          state: 'home'
  action:
    service_template: "switch.turn_on"
    entity_id: switch.jasco_products_28169_plug_in_one_outlet_smart_switch_switch
- alias: 'Espresso Machine Off'
  trigger:
    - platform: time
      at: '16:00:00'
  condition:
      condition: and
      conditions:
        - condition: state
          entity_id: switch.jasco_products_28169_plug_in_one_outlet_smart_switch_switch
          state: 'on'
  action:
    - service_template: "switch.turn_off"
      entity_id: switch.jasco_products_28169_plug_in_one_outlet_smart_switch_switch
    - service: notify.alexa_media_kitchen_dot
      data:
        message: "The Espresso Machine was turned off"
        data:
          type: tts
- alias: 'Espresso Machine Off When Away'
  trigger:
    - platform: time
      at: '9:00:00'
  condition:
      condition: and
      conditions:
        - condition: state
          entity_id: group.mobile_trackers
          state: 'not_home'
          for:
            hours: 1
        - condition: state
          entity_id: switch.jasco_products_28169_plug_in_one_outlet_smart_switch_switch
          state: 'on'
  action:
    - service_template: "switch.turn_off"
      entity_id: switch.jasco_products_28169_plug_in_one_outlet_smart_switch_switch
    - service: notify.mobile_app_echelon
      data:
        title: "Home Assistant Alerts"
        message: "Espresso Machine was turned off as no one is home."
        data:
          subtitle: "Away"

