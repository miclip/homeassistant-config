#####################################################################################
# Automation for when we're five minutes away
#####################################################################################

- alias: 'Automation five minutes away'
  trigger:
      platform: numeric_state
      entity_id: sensor.michael_to_home
      above: 5
      for: "00:01:00"
  condition:
      condition: and
      conditions:
          - condition: state
            entity_id: group.mobile_trackers
            state: "not_home"
          - condition: or
            conditions:
                - condition: state
                  entity_id: lock.schlage_allegion_unknown_type_0001_id_0468_locked
                  state: "unlocked"
                - condition: state
                  entity_id: lock.schlage_allegion_be469zp_connect_smart_deadbolt_locked
                  state: "unlocked"
  action:
    - service_template: "lock.lock"
      entity_id: lock.schlage_allegion_unknown_type_0001_id_0468_locked
    - service_template: "lock.lock"
      entity_id: lock.schlage_allegion_be469zp_connect_smart_deadbolt_locked
    - service: notify.mobile_app_echelon
      data:
        title: "Home Assistant Alerts"
        message: "Detected you are greater then five minutes from home, any unlocked doors have been locked."
        data:
          subtitle: "Away mode Automation"

#####################################################################################
# Automation for when we're more then an hour away
#####################################################################################
#####################################################################################
# Automation for when we're heading home after being an hour away
#####################################################################################
